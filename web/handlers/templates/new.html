{{template "base" .}}

{{define "title"}}New Debate - dbate{{end}}

{{define "content"}}
<div class="max-w-2xl mx-auto">
    <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-900">Start a New Debate</h1>
        <p class="mt-1 text-sm text-gray-500">Configure your AI debate and watch the discussion unfold.</p>
    </div>

    <form hx-post="/debates" hx-indicator="#submit-spinner" class="space-y-6 bg-white shadow-sm rounded-lg p-6">
        <!-- Topic -->
        <div>
            <label for="topic" class="block text-sm font-medium text-gray-700">Topic</label>
            <textarea
                id="topic"
                name="topic"
                rows="3"
                required
                placeholder="Enter the topic for debate..."
                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-3"
            ></textarea>
            <p class="mt-1 text-xs text-gray-500">What should the AI agents debate about?</p>
        </div>

        <!-- Debate Style & Mode -->
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label for="style" class="block text-sm font-medium text-gray-700">Debate Style</label>
                <select
                    id="style"
                    name="style"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                >
                    {{range .Styles}}
                    <option value="{{.ID}}" {{if eq .ID "collaborative"}}selected{{end}}>{{.Name}}</option>
                    {{end}}
                </select>
            </div>
            <div>
                <label for="mode" class="block text-sm font-medium text-gray-700">Execution Mode</label>
                <select
                    id="mode"
                    name="mode"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                >
                    <option value="automatic" selected>Automatic - Run all turns</option>
                    <option value="turn_by_turn">Turn-by-turn - Manual control</option>
                </select>
            </div>
        </div>

        <!-- Agent A -->
        <div class="border rounded-lg p-4 bg-blue-50">
            <h3 class="font-medium text-gray-900 mb-3">Agent A</h3>
            <div class="grid grid-cols-3 gap-4">
                <div>
                    <label for="agent_a_provider" class="block text-sm font-medium text-gray-700">Provider</label>
                    <select
                        id="agent_a_provider"
                        name="agent_a_provider"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                    >
                        {{range .Providers}}
                        <option value="{{.Name}}" data-models="{{range $i, $m := .Models}}{{if $i}},{{end}}{{$m}}{{end}}">{{.DisplayName}}</option>
                        {{end}}
                    </select>
                </div>
                <div>
                    <label for="agent_a_model" class="block text-sm font-medium text-gray-700">Model (optional)</label>
                    <input
                        type="text"
                        id="agent_a_model"
                        name="agent_a_model"
                        placeholder="Default model"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                    >
                </div>
                <div>
                    <label for="agent_a_persona" class="block text-sm font-medium text-gray-700">Persona</label>
                    <select
                        id="agent_a_persona"
                        name="agent_a_persona"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                    >
                        {{range .Personas}}
                        <option value="{{.ID}}" {{if eq .ID "pragmatist"}}selected{{end}}>{{.Name}}</option>
                        {{end}}
                    </select>
                </div>
            </div>
        </div>

        <!-- Agent B -->
        <div class="border rounded-lg p-4 bg-green-50">
            <h3 class="font-medium text-gray-900 mb-3">Agent B</h3>
            <div class="grid grid-cols-3 gap-4">
                <div>
                    <label for="agent_b_provider" class="block text-sm font-medium text-gray-700">Provider</label>
                    <select
                        id="agent_b_provider"
                        name="agent_b_provider"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                    >
                        {{range .Providers}}
                        <option value="{{.Name}}" data-models="{{range $i, $m := .Models}}{{if $i}},{{end}}{{$m}}{{end}}">{{.DisplayName}}</option>
                        {{end}}
                    </select>
                </div>
                <div>
                    <label for="agent_b_model" class="block text-sm font-medium text-gray-700">Model (optional)</label>
                    <input
                        type="text"
                        id="agent_b_model"
                        name="agent_b_model"
                        placeholder="Default model"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                    >
                </div>
                <div>
                    <label for="agent_b_persona" class="block text-sm font-medium text-gray-700">Persona</label>
                    <select
                        id="agent_b_persona"
                        name="agent_b_persona"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                    >
                        {{range .Personas}}
                        <option value="{{.ID}}" {{if eq .ID "skeptic"}}selected{{end}}>{{.Name}}</option>
                        {{end}}
                    </select>
                </div>
            </div>
        </div>

        <!-- Settings -->
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label for="max_turns" class="block text-sm font-medium text-gray-700">Turns per Agent</label>
                <input
                    type="number"
                    id="max_turns"
                    name="max_turns"
                    value="5"
                    min="1"
                    max="20"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                >
                <p class="mt-1 text-xs text-gray-500">Total turns = 2x this value</p>
            </div>
            <div class="flex items-center pt-6">
                <input
                    type="checkbox"
                    id="auto_run"
                    name="auto_run"
                    checked
                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                >
                <label for="auto_run" class="ml-2 block text-sm text-gray-900">
                    Start debate immediately
                </label>
            </div>
        </div>

        <!-- Submit -->
        <div class="flex justify-end space-x-3">
            <a href="/debates" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                Cancel
            </a>
            <button
                type="submit"
                class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
            >
                <span id="submit-spinner" class="htmx-indicator mr-2">
                    <svg class="animate-spin h-4 w-4 text-white" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                    </svg>
                </span>
                Create Debate
            </button>
        </div>
    </form>
</div>
{{end}}
